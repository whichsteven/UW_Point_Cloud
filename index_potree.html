<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="description" content="">
	<meta name="author" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
	<title>Potree Viewer</title>

	<link rel="stylesheet" type="text/css" href="libs/potree/potree.css">
	<link rel="stylesheet" type="text/css" href="libs/jquery-ui/jquery-ui.min.css">
	<link rel="stylesheet" type="text/css" href="libs/perfect-scrollbar/css/perfect-scrollbar.css">
	<link rel="stylesheet" type="text/css" href="libs/openlayers3/ol.css">
	<link rel="stylesheet" type="text/css" href="libs/spectrum/spectrum.css">
	<link rel="stylesheet" type="text/css" href="libs/jstree/themes/mixed/style.css">
</head>

<body>
	<script src="libs/jquery/jquery-3.1.1.min.js"></script>
	<script src="libs/spectrum/spectrum.js"></script>
	<script src="libs/perfect-scrollbar/js/perfect-scrollbar.jquery.js"></script>
	<script src="libs/jquery-ui/jquery-ui.min.js"></script>
	<script src="libs/three.js/build/three.min.js"></script>
	<script src="libs/other/BinaryHeap.js"></script>
	<script src="libs/tween/tween.min.js"></script>
	<script src="libs/d3/d3.js"></script>
	<script src="libs/proj4/proj4.js"></script>
	<script src="libs/openlayers3/ol.js"></script>
	<script src="libs/i18next/i18next.js"></script>
	<script src="libs/jstree/jstree.js"></script>
	<script src="libs/potree/potree.js"></script>
	<script src="libs/plasio/js/laslaz.js"></script>

	<!-- INCLUDE ADDITIONAL DEPENDENCIES HERE -->
	document.title = "";
	viewer.setEDLEnabled(false);
	viewer.setBackground("gradient"); // ["skybox", "gradient", "black", "white"];
	viewer.setDescription(``);

	<div class="potree_container" style="position: absolute; width: 100%; height: 100%; left: 0px; top: 0px; ">
		<div class="btn-group" style="position: absolute; z-index: 2;">
			<button onclick="recenter()">Re-Center</button>
			<button onclick="low_pt_budget()">Low Resolution</button>
			<button onclick="medium_pt_budget()">Medium Resolution</button>
			<button onclick="high_pt_budget()">High Resolution</button>
		</div>
		<div id="potree_render_area"></div>
		<!-- <div id="potree_sidebar_container"> </div> -->
	</div>


	<script>
		window.viewer = new Potree.Viewer(document.getElementById("potree_render_area"));

		viewer.setEDLEnabled(true);
		viewer.setFOV(60);
		viewer.setPointBudget(1 * 1000 * 1000);
		document.title = "";
		viewer.setEDLEnabled(false);
		viewer.setBackground("gradient"); // ["skybox", "gradient", "black", "white"];
		viewer.setDescription(``);
		viewer.loadSettingsFromURL();
		viewer.useHQ = true; // use high quality splat

		// viewer.loadGUI(() => {
		// 	viewer.setLanguage('en');
		// 	$("#menu_appearance").next().show();
		// 	$("#menu_tools").next().show();
		// 	$("#menu_scene").next().show();
		// 	viewer.toggleSidebar();
		// });

		let sceneSG = new Potree.Scene();
		viewer.setScene(sceneSG);

		Potree.loadPointCloud("pointclouds/UW_Campus/cloud.js", "UW_Campus", e => {
			sceneSG.addPointCloud(e.pointcloud);
			sceneSG.view.position.set(2.509, 44.291, 29.728);
			sceneSG.view.lookAt(new THREE.Vector3(23.181, 9.231, 9.172));

			let material = e.pointcloud.material;
			material.pointColorType = Potree.PointColorType.RGB; // any Potree.PointColorType.XXXX
			material.size = 1;
			material.pointSizeType = Potree.PointSizeType.ADAPTIVE;
			material.shape = Potree.PointShape.SQUARE;


			// annotations

			// Anderson Hall
			{
				{
					let elTitle = $(`
						<span>Anderson Hall</span>
					`);
					// elTitle.find("img[name=action_set_scene]").click((event) => {
					// 	event.stopPropagation();
					// 	viewer.setScene(sceneLion);
					// });
					elTitle.toString = () => "Anderson Hall";

					let and_hall = new Potree.Annotation({
						position: [28.960, 1.340, 4.171],
						title: elTitle,
						cameraPosition: [16.735, 30.486, 3.485],
						cameraTarget: [29.124, 4.296, 4.423],
						description: `<ul><li>Click on the annotation label to move a predefined view.</li>
						<li>Click on the icon to execute the specified action.</li>
						In this case, the action will bring you to another scene and point cloud.</ul>`
					});

					sceneSG.annotations.add(and_hall);
				}


				// Winkenwerder Forest Sciences Laboratory
				{
					let wfs_hall = new Potree.Annotation({
						position: [69.347, -20.668, 4.144],
						"cameraPosition": [48.144, -18.489, -1.583],
						"cameraTarget": [67.554, -23.281, 1.823],
						"title": "Winkenwerder Forest Sciences Laboratory",
						"description": `
						Suitable annotation positions and views can be obtained by
						looking up the current camera position and target in the "Scene" panel,
						or by evaluating following lines in your browser's developer console:<br><br>
						<code>viewer.scene.view.position</code><br>
						<code>viewer.scene.view.getPivot()</code><br>
						`
					});
					sceneSG.annotations.add(wfs_hall);
				}

				// Bloedal Hall
				{
					let bld_hall = new Potree.Annotation({
						position: [4.286, -46.089, 6.392],
						"cameraPosition": [15.785, -16.873, -0.772],
						"cameraTarget": [12.691, -29.520, 1.783],
						"title": "Bloedal Hall",
						"description": `
						Suitable annotation positions and views can be obtained by
						looking up the current camera position and target in the "Scene" panel,
						or by evaluating following lines in your browser's developer console:<br><br>
						<code>viewer.scene.view.position</code><br>
						<code>viewer.scene.view.getPivot()</code><br>
						`
					});
					sceneSG.annotations.add(bld_hall);
				}

				// Stevens Way
				{
					let stevens_way = new Potree.Annotation({
						position: [21.627, 31.153, 1.753],
						"cameraPosition": [-22.471, 37.657, 3.982],
						"cameraTarget": [39.327, 24.035, 6.030],
						"title": "Stevens Way",
						"description": `
						Suitable annotation positions and views can be obtained by
						looking up the current camera position and target in the "Scene" panel,
						or by evaluating following lines in your browser's developer console:<br><br>
						<code>viewer.scene.view.position</code><br>
						<code>viewer.scene.view.getPivot()</code><br>
						`
					});
					sceneSG.annotations.add(stevens_way);
				}

			}
		});

		function recenter() {
			sceneSG.view.position.set(2.509, 44.291, 29.728);
			sceneSG.view.lookAt(new THREE.Vector3(23.181, 9.231, 9.172));
		}

		function low_pt_budget() {
			viewer.setPointBudget(1 * 1000 * 500);
		}

		function medium_pt_budget() {
			viewer.setPointBudget(1 * 1000 * 1000);
		}

		function high_pt_budget() {
			viewer.setPointBudget(1 * 1000 * 10000);
		}
	</script>



</body>

</html>
